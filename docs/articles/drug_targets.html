<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Building protein networks around drug-targets using OmnipathR • OmnipathR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Building protein networks around drug-targets using OmnipathR">
<meta property="og:description" content="OmnipathR">
<meta property="og:image" content="https://saezlab.github.io/OmnipathR/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-119440867-10"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-119440867-10');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OmnipathR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/drug_targets.html">Building protein networks around drug-targets using OmnipathR</a>
    </li>
    <li>
      <a href="../articles/omnipath_intro.html">OmnipathR: utility functions to work with OmniPath in R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/saezlab/OmnipathR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/omnipathdb">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://omnipathdb.org/">
    <span class="fas fa fas fa-university"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="drug_targets_files/header-attrs-2.4/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Building protein networks around drug-targets using OmnipathR</h1>
                        <h4 class="author">Attila Gabor</h4>
            <address class="author_afil">
      Institute for Computational Biomedicine, Heidelberg University<br><a class="author_email" href="mailto:#"></a><a href="mailto:attila.gabor@bioquant.uni-heidelberg.de" class="email">attila.gabor@bioquant.uni-heidelberg.de</a>
      </address>
                              <h4 class="author">Alberto Valdeolivas</h4>
            <address class="author_afil">
      Institute for Computational Biomedicine, Heidelberg University<br><h4 class="author">Julio Saez-Rodriguez</h4>
            <address class="author_afil">
      Institute for Computational Biomedicine, Heidelberg University<br><small class="dont-index">Source: <a href="https://github.com/saezlab/OmnipathR/blob/master/vignettes/drug_targets.Rmd"><code>vignettes/drug_targets.Rmd</code></a></small>
      <div class="hidden name"><code>drug_targets.Rmd</code></div>

    </address>
</address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Many applications require to connect drugs to proteins in signaling networks. OmnipathR provides easy access to curated pathway resources from OmniPath. Here we use data from DrugBank to find direct protein targets of drugs and to connect them to downstream signaling proteins using OmnipathR.</p>
    </div>
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In many applications we would like to understand how a specific drug interacts with the protein signaling network through its targets.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://saezlab.github.io/OmnipathR/">OmnipathR</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://igraph.org">igraph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span></pre></div>
</div>
<div id="initialise-omnipath-database" class="section level1">
<h1 class="hasAnchor">
<a href="#initialise-omnipath-database" class="anchor"></a>Initialise OmniPath database</h1>
<p>We query protein-protein interactions from the webservice of OmniPath [1,2] at <a href="https://omnipathdb.org/" class="uri">https://omnipathdb.org/</a> using OmnipathR package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># Download protein-protein interactions</span>
<span class="va">interactions</span> <span class="op">=</span> <span class="fu"><a href="../reference/import_omnipath_interactions.html">import_omnipath_interactions</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<pre><code>## Downloaded 41419 interactions.</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># Convert to igraph objects:</span>
<span class="va">OPI_g</span> <span class="op">=</span> <span class="fu"><a href="../reference/interaction_graph.html">interaction_graph</a></span><span class="op">(</span>interactions <span class="op">=</span> <span class="va">interactions</span> <span class="op">)</span></pre></div>
</div>
<div id="querying-drug-targets" class="section level1">
<h1 class="hasAnchor">
<a href="#querying-drug-targets" class="anchor"></a>Querying drug targets</h1>
<p>For direct drug targets we will use DrugBank [3] database accessed via the <em><a href="https://CRAN.R-project.org/package=dbparser">dbparser</a></em> package. Please note, that the following few chuncks of code is not evaluated. DrugBank requires registrations to access the data, therefore we ask the reader to register at DrugBank and download the data from <a href="https://www.drugbank.ca/releases/latest">here</a>.</p>
<p>The next block of code is used to process the DrugBank dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dbparser</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.omegahat.net/RSXML">XML</a></span><span class="op">)</span>


<span class="co">## parse data from XML and save it to memory</span>
<span class="fu">get_xml_db_rows</span><span class="op">(</span><span class="st">"..path-to-DrugBank/full database.xml"</span><span class="op">)</span>

<span class="co">## load drugs data</span>
<span class="va">drugs</span> <span class="op">&lt;-</span> <span class="fu">parse_drug</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">primary_key</span>, <span class="va">name</span><span class="op">)</span>
<span class="va">drugs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="va">drugs</span>,drug_name <span class="op">=</span> <span class="va">name</span><span class="op">)</span>

<span class="co">## load drug target data</span>
<span class="va">drug_targets</span> <span class="op">&lt;-</span> <span class="fu">parse_drug_targets</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">name</span>,<span class="va">organism</span>,<span class="va">parent_key</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>target_name <span class="op">=</span> <span class="va">name</span><span class="op">)</span>

<span class="co">## load polypeptide data</span>
<span class="va">drug_peptides</span> <span class="op">&lt;-</span> <span class="fu">parse_drug_targets_polypeptides</span><span class="op">(</span><span class="op">)</span>  <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">name</span>, <span class="va">general_function</span>, <span class="va">specific_function</span>,
          <span class="va">gene_name</span>, <span class="va">parent_id</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>target_name <span class="op">=</span> <span class="va">name</span>, gene_id <span class="op">=</span> <span class="va">id</span><span class="op">)</span>

<span class="co"># join the 3 datasets</span>
<span class="va">drug_targets_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">drug_targets</span>, <span class="va">drug_peptides</span>,
                                by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span><span class="op">=</span><span class="st">"parent_id"</span>, <span class="st">"target_name"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">drugs</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"parent_key"</span><span class="op">=</span><span class="st">"primary_key"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">other_keys</span><span class="op">)</span></pre></div>
<p>Here we declare the names of drugs of interest.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">drug_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Valproat"</span>      <span class="op">=</span> <span class="st">"Valproic Acid"</span>,
               <span class="st">"Diclofenac"</span>    <span class="op">=</span> <span class="st">"Diclofenac"</span>,
               <span class="st">"Paracetamol"</span>   <span class="op">=</span> <span class="st">"Acetaminophen"</span>,
               <span class="st">"Ciproflaxin"</span>   <span class="op">=</span> <span class="st">"Ciprofloxacin"</span>,
               <span class="st">"Nitrofurantoin"</span><span class="op">=</span> <span class="st">"Nitrofurantoin"</span>,
               <span class="st">"Tolcapone"</span>,
               <span class="st">"Azathioprine"</span>,
               <span class="st">"Troglitazone"</span>,
               <span class="st">"Nefazodone"</span>,
               <span class="st">"Ketoconazole"</span>,
               <span class="st">"Omeprazole"</span>,
               <span class="st">"Phenytoin"</span>,
               <span class="st">"Amiodarone"</span>,
               <span class="st">"Cisplatin"</span>,
               <span class="st">"Cyclosporin A"</span>  <span class="op">=</span> <span class="st">"Cyclosporine"</span>,
               <span class="st">"Verapamil"</span>,
               <span class="st">"Buspirone"</span>,
               <span class="st">"Melatonin"</span>,
               <span class="st">"N-Acetylcysteine"</span><span class="op">=</span> <span class="st">"Acetylcysteine"</span>,
               <span class="st">"Vitamin C"</span>       <span class="op">=</span> <span class="st">"Ascorbic acid"</span>,
               <span class="st">"Famotidine"</span>,
               <span class="st">"Vancomycin"</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">drug_target_data_sample</span> <span class="op">&lt;-</span> <span class="va">drug_targets_full</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">organism</span> <span class="op">==</span> <span class="st">"Humans"</span>,<span class="va">drug_name</span> <span class="op">%in%</span> <span class="va">drug_names</span><span class="op">)</span></pre></div>
<p>We only use a small sample of the database:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">drug_targets</span> <span class="op">&lt;-</span> <span class="fu">OmnipathR</span><span class="fu">:::</span><span class="va">drug_target_data_sample</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">organism</span> <span class="op">==</span> <span class="st">"Humans"</span>,<span class="va">drug_name</span> <span class="op">%in%</span> <span class="va">drug_names</span><span class="op">)</span></pre></div>
<div id="quality-control" class="section level2">
<h2 class="hasAnchor">
<a href="#quality-control" class="anchor"></a>Quality control</h2>
<p>Check which drug targets are in Omnipath</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="va">drug_targets</span> <span class="op">&lt;-</span>  <span class="va">drug_targets</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">target_name</span>, <span class="op">-</span><span class="va">organism</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>in_OP <span class="op">=</span> <span class="va">gene_id</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">interactions</span><span class="op">$</span><span class="va">source</span><span class="op">)</span><span class="op">)</span>
<span class="co"># not all drug-targets are in OP.</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">drug_targets</span><span class="op">$</span><span class="va">in_OP</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co"># But each drug has at least one target in OP.</span>
<span class="va">drug_targets</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">drug_name</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">in_OP</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 19 x 2
##    drug_name      `any(in_OP)`
##    &lt;chr&gt;          &lt;lgl&gt;       
##  1 Acetaminophen  TRUE        
##  2 Acetylcysteine TRUE        
##  3 Amiodarone     TRUE        
##  4 Ascorbic acid  TRUE        
##  5 Azathioprine   TRUE        
##  6 Buspirone      TRUE        
##  7 Ciprofloxacin  FALSE       
##  8 Cisplatin      TRUE        
##  9 Diclofenac     TRUE        
## 10 Famotidine     TRUE        
## 11 Ketoconazole   TRUE        
## 12 Melatonin      TRUE        
## 13 Nefazodone     TRUE        
## 14 Omeprazole     TRUE        
## 15 Phenytoin      TRUE        
## 16 Tolcapone      TRUE        
## 17 Troglitazone   TRUE        
## 18 Valproic Acid  TRUE        
## 19 Verapamil      TRUE</code></pre>
</div>
</div>
<div id="downstream-signaling-nodes" class="section level1">
<h1 class="hasAnchor">
<a href="#downstream-signaling-nodes" class="anchor"></a>Downstream signaling nodes</h1>
<p>We would like to investigate the effect of the drugs on some selected proteins. For example, the activity of these proteins are measured upon the drug perturbation. We’ll build a network from the drug targets to these selected nodes.</p>
<p>First we declare protein of interest (POI):</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="va">POI</span> <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>protein <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NFE2L2"</span>,<span class="st">"HMOX1"</span>,<span class="st">"TP53"</span>,<span class="st">"CDKN1A"</span>,<span class="st">"BTG2"</span>,<span class="st">"NFKB1"</span>,
                         <span class="st">"ICAM1"</span>,<span class="st">"HSPA5"</span>, <span class="st">"ATF4"</span>,<span class="st">"DDIT3"</span>,<span class="st">"XBP1"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div id="quality-control-1" class="section level2">
<h2 class="hasAnchor">
<a href="#quality-control-1" class="anchor"></a>Quality control</h2>
<p>Checking which POI are in Omnipath</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="va">POI</span> <span class="op">&lt;-</span> <span class="va">POI</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>in_OP <span class="op">=</span> <span class="va">protein</span> <span class="op">%in%</span> <span class="va">interactions</span><span class="op">$</span><span class="va">target_genesymbol</span><span class="op">)</span>
<span class="co"># all POI is in Omnipath</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">POI</span><span class="op">$</span><span class="va">in_OP</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="build-network-between-drug-targets-and-poi" class="section level1">
<h1 class="hasAnchor">
<a href="#build-network-between-drug-targets-and-poi" class="anchor"></a>Build network between drug targets and POI</h1>
<p>First, we find paths between the drug targets and the POIs. For the sake of this simplicity we focus on drug targets of one drug, <em>Cisplatin</em>.</p>
<p>The paths are represented by a set of nodes:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="va">source_nodes</span> <span class="op">&lt;-</span> <span class="va">drug_targets</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">in_OP</span>, <span class="va">drug_name</span><span class="op">==</span><span class="st">"Cisplatin"</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">gene_name</span><span class="op">)</span>
<span class="va">target_nodes</span> <span class="op">&lt;-</span> <span class="va">POI</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">in_OP</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">protein</span><span class="op">)</span>

<span class="va">collected_path_nodes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i_source</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">source_nodes</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>

   <span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/distances.html">shortest_paths</a></span><span class="op">(</span><span class="va">OPI_g</span>, from <span class="op">=</span> <span class="va">source_nodes</span><span class="op">[[</span><span class="va">i_source</span><span class="op">]</span><span class="op">]</span>,
                           to <span class="op">=</span> <span class="va">target_nodes</span>,
                           output <span class="op">=</span> <span class="st">'vpath'</span><span class="op">)</span>
   <span class="va">path_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">paths</span><span class="op">$</span><span class="va">vpath</span>,<span class="va">names</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span>
   <span class="va">collected_path_nodes</span><span class="op">[[</span><span class="va">i_source</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">path_nodes</span>
<span class="op">}</span>
<span class="va">collected_path_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">collected_path_nodes</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<p>The direct drug targets, the POIs and the intermediate pathway members give rise to the network.</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="va">cisplatin_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">source_nodes</span>,<span class="va">target_nodes</span>, <span class="va">collected_path_nodes</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">cisplatin_network</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/subgraph.html">induced_subgraph</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">OPI_g</span>,vids <span class="op">=</span> <span class="va">cisplatin_nodes</span><span class="op">)</span></pre></div>
<p>We annotate the nodes of the network and plot it.</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">cisplatin_network</span><span class="op">)</span><span class="op">$</span><span class="va">node_type</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
   <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">cisplatin_network</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op">%in%</span> <span class="va">source_nodes</span>, <span class="st">"direct drug target"</span>,
   <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">cisplatin_network</span><span class="op">)</span><span class="op">$</span><span class="va">name</span> <span class="op">%in%</span> <span class="va">target_nodes</span>,<span class="st">"POI"</span>,<span class="st">"intermediate node"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span>
      <span class="va">cisplatin_network</span>,
      layout <span class="op">=</span> <span class="st">"lgl"</span>,
      area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">vcount</a></span><span class="op">(</span><span class="va">cisplatin_network</span><span class="op">)</span><span class="op">^</span><span class="fl">2.3</span>,
      repulserad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">vcount</a></span><span class="op">(</span><span class="va">cisplatin_network</span><span class="op">)</span><span class="op">^</span><span class="fl">1.2</span>,
      coolexp <span class="op">=</span> <span class="fl">1.1</span>
   <span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>
         start_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">label_rect</a></span><span class="op">(</span><span class="va">node1.name</span><span class="op">)</span>,
         end_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html">label_rect</a></span><span class="op">(</span><span class="va">node2.name</span><span class="op">)</span><span class="op">)</span>,
         arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">'mm'</span><span class="op">)</span>
      <span class="op">)</span>,
      edge_width <span class="op">=</span> <span class="fl">.5</span>,
      edge_alpha <span class="op">=</span> <span class="fl">.2</span>
   <span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_label</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">name</span>, color <span class="op">=</span> <span class="va">node_type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_hue.html">scale_color_discrete</a></span><span class="op">(</span>
      guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">'Node type'</span><span class="op">)</span>
   <span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Cisplatin induced network"</span><span class="op">)</span></pre></div>
<p><img src="drug_targets_files/figure-html/unnamed-chunk-12-1.png" width="700"> The above network represents a way how Cisplatin can influence the POIs. One can for example filter out edges based on the number fo resources reporting the edge or based on the number of papers mentioning it. However, this is already covered by previous pypath tutorials.</p>
</div>
<div id="acknowledgements" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h1>
<p>The above pipeline was inspired by the post of Denes Turei available <a href="https://groups.google.com/forum/#!msg/omnipath/IAV5PEXRyMg/PvwOKkusBQAJ">here</a>.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>[1] D Turei, A Valdeolivas, L Gul, N Palacio-Escat, O Ivanova, A Gabor, D Modos, T Korcsmaros and J Saez-Rodriguez (2020) Integrated intra- and intercellular signaling knowledge for multicellular omics analysis. <em>bioRxiv</em> 2020.08.03.221242</p>
<p>[2] D Turei, T Korcsmaros and J Saez-Rodriguez (2016) OmniPath: guidelines and gateway for literature-curated signaling pathway resources. <em>Nature Methods</em> 13(12)</p>
<p>[3] Wishart DS, Feunang YD, Guo AC, Lo EJ, Marcu A, Grant JR, Sajed T, Johnson D, Li C, Sayeeda Z, Assempour N, Iynkkaran I, Liu Y, Maciejewski A, Gale N, Wilson A, Chin L, Cummings R, Le D, Pon A, Knox C, Wilson M. DrugBank 5.0: a major update to the DrugBank database for 2018. <em>Nucleic Acids Res.</em> 2017 Nov 8. doi: 10.1093/nar/gkx1037.</p>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<pre><code>## R version 4.0.2 (2020-06-22)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Arch Linux
## 
## Matrix products: default
## BLAS:   /usr/lib/libblas.so.3.9.0
## LAPACK: /usr/lib/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] ggraph_2.0.3     OmnipathR_1.4.0  jsonlite_1.7.1   igraph_1.2.5    
## [5] ggplot2_3.3.2    dplyr_1.0.2      BiocStyle_2.16.1
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.1.0    xfun_0.18           purrr_0.3.4        
##  [4] graphlayouts_0.7.0  colorspace_1.4-1    vctrs_0.3.4        
##  [7] generics_0.0.2      htmltools_0.5.0     viridisLite_0.3.0  
## [10] yaml_2.2.1          utf8_1.1.4          rlang_0.4.7        
## [13] pkgdown_1.6.1       pillar_1.4.6        glue_1.4.2         
## [16] withr_2.3.0         tweenr_1.0.1        lifecycle_0.2.0    
## [19] stringr_1.4.0       munsell_0.5.0       gtable_0.3.0       
## [22] ragg_0.3.1          memoise_1.1.0       evaluate_0.14      
## [25] labeling_0.3        knitr_1.30          fansi_0.4.1        
## [28] tidygraph_1.2.0     Rcpp_1.0.5          scales_1.1.1       
## [31] backports_1.1.10    BiocManager_1.30.10 desc_1.2.0         
## [34] farver_2.0.3        systemfonts_0.3.2   fs_1.5.0           
## [37] gridExtra_2.3       ggforce_0.3.2       digest_0.6.25      
## [40] stringi_1.5.3       bookdown_0.20       ggrepel_0.8.2      
## [43] polyclip_1.10-0     grid_4.0.2          rprojroot_1.3-2    
## [46] cli_2.0.2           tools_4.0.2         magrittr_1.5       
## [49] tibble_3.0.3        crayon_1.3.4        tidyr_1.1.2        
## [52] pkgconfig_2.0.3     ellipsis_0.3.1      MASS_7.3-53        
## [55] assertthat_0.2.1    rmarkdown_2.4       viridis_0.5.1      
## [58] R6_2.4.1            compiler_4.0.2</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alberto Valdeolivas, Denes Turei, Attila Gabor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
